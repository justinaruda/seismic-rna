<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>seismicrna.core.batch package &mdash; seismic-rna  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon-32x32.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="seismicrna.core.batch.tests package" href="seismicrna.core.batch.tests.html" />
    <link rel="prev" title="seismicrna.core.arg package" href="seismicrna.core.arg.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            seismic-rna
              <img src="../_static/logo-200.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../steps/index.html">Step-By-Step</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto/index.html">How To</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Commands, Arguments, Options</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="seismicrna.html">seismicrna package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="seismicrna.html#seismic-rna">SEISMIC-RNA</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="seismicrna.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="seismicrna.align.html">seismicrna.align package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.cleanfa.html">seismicrna.cleanfa package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.cluster.html">seismicrna.cluster package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="seismicrna.core.html">seismicrna.core package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="seismicrna.core.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="seismicrna.core.html#module-seismicrna.core.array">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.demult.html">seismicrna.demult package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.export.html">seismicrna.export package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.fold.html">seismicrna.fold package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.graph.html">seismicrna.graph package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.joinbase.html">seismicrna.joinbase package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.lists.html">seismicrna.lists package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.mask.html">seismicrna.mask package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.pool.html">seismicrna.pool package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.relate.html">seismicrna.relate package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.renumct.html">seismicrna.renumct package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.sim.html">seismicrna.sim package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.table.html">seismicrna.table package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.test.html">seismicrna.test package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.wf.html">seismicrna.wf package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="seismicrna.html#module-seismicrna.join">Submodules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../formats/index.html">File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/index.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algos/index.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Bugs and Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../writeme.html">How to Write this Manual</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">seismic-rna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="seismicrna.html">seismicrna package</a></li>
          <li class="breadcrumb-item"><a href="seismicrna.core.html">seismicrna.core package</a></li>
      <li class="breadcrumb-item active">seismicrna.core.batch package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/seismicrna.core.batch.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-seismicrna.core.batch">
<span id="seismicrna-core-batch-package"></span><h1>seismicrna.core.batch package<a class="headerlink" href="#module-seismicrna.core.batch" title="Permalink to this headline"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="seismicrna.core.batch.tests.html">seismicrna.core.batch.tests package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="seismicrna.core.batch.tests.html#module-seismicrna.core.batch.tests.count_test">Submodules</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="module-seismicrna.core.batch.accum">
<span id="submodules"></span><h2>Submodules<a class="headerlink" href="#module-seismicrna.core.batch.accum" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.accum.accum_fits">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.accum.</span></span><span class="sig-name descname"><span class="pre">accum_fits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#seismicrna.core.batch.muts.SectionMutsBatch" title="seismicrna.core.batch.muts.SectionMutsBatch"><span class="pre">seismicrna.core.batch.muts.SectionMutsBatch</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refseq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.seq.html#seismicrna.core.seq.xna.DNA" title="seismicrna.core.seq.xna.DNA"><span class="pre">seismicrna.core.seq.xna.DNA</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_nums</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="seismicrna.core.rel.html#seismicrna.core.rel.pattern.RelPattern" title="seismicrna.core.rel.pattern.RelPattern"><span class="pre">seismicrna.core.rel.pattern.RelPattern</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.accum.accum_fits" title="Permalink to this definition"></a></dt>
<dd><p>Count positions and reads fitting each relationship.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.accum.accum_per_pos">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.accum.</span></span><span class="sig-name descname"><span class="pre">accum_per_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#seismicrna.core.batch.muts.SectionMutsBatch" title="seismicrna.core.batch.muts.SectionMutsBatch"><span class="pre">seismicrna.core.batch.muts.SectionMutsBatch</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refseq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.seq.html#seismicrna.core.seq.xna.DNA" title="seismicrna.core.seq.xna.DNA"><span class="pre">seismicrna.core.seq.xna.DNA</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_nums</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="seismicrna.core.rel.html#seismicrna.core.rel.pattern.RelPattern" title="seismicrna.core.rel.pattern.RelPattern"><span class="pre">seismicrna.core.rel.pattern.RelPattern</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.accum.accum_per_pos" title="Permalink to this definition"></a></dt>
<dd><p>Count reads with each relationship at each position in a section
over multiple batches.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.accum.accumulate">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.accum.</span></span><span class="sig-name descname"><span class="pre">accumulate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#seismicrna.core.batch.muts.SectionMutsBatch" title="seismicrna.core.batch.muts.SectionMutsBatch"><span class="pre">seismicrna.core.batch.muts.SectionMutsBatch</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refseq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.seq.html#seismicrna.core.seq.xna.DNA" title="seismicrna.core.seq.xna.DNA"><span class="pre">seismicrna.core.seq.xna.DNA</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">patterns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="seismicrna.core.rel.html#seismicrna.core.rel.pattern.RelPattern" title="seismicrna.core.rel.pattern.RelPattern"><span class="pre">seismicrna.core.rel.pattern.RelPattern</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_nums</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_read</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_info</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">count_ends</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.accum.accumulate" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<span class="target" id="module-seismicrna.core.batch.count"></span><dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.count.calc_count_per_pos">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.count.</span></span><span class="sig-name descname"><span class="pre">calc_count_per_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.rel.html#seismicrna.core.rel.pattern.RelPattern" title="seismicrna.core.rel.pattern.RelPattern"><span class="pre">seismicrna.core.rel.pattern.RelPattern</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cover_per_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rels_per_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.count.calc_count_per_pos" title="Permalink to this definition"></a></dt>
<dd><p>Count the reads that fit a pattern at each position.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.count.calc_count_per_read">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.count.</span></span><span class="sig-name descname"><span class="pre">calc_count_per_read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.rel.html#seismicrna.core.rel.pattern.RelPattern" title="seismicrna.core.rel.pattern.RelPattern"><span class="pre">seismicrna.core.rel.pattern.RelPattern</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">cover_per_read</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rels_per_read</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.count.calc_count_per_read" title="Permalink to this definition"></a></dt>
<dd><p>Count the positions that fit a pattern in each read.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.count.calc_coverage">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.count.</span></span><span class="sig-name descname"><span class="pre">calc_coverage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.indexes.base.Index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_nums</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.count.calc_coverage" title="Permalink to this definition"></a></dt>
<dd><p>Number of positions covered by each read.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.count.calc_reads_per_pos">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.count.</span></span><span class="sig-name descname"><span class="pre">calc_reads_per_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.rel.html#seismicrna.core.rel.pattern.RelPattern" title="seismicrna.core.rel.pattern.RelPattern"><span class="pre">seismicrna.core.rel.pattern.RelPattern</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.indexes.base.Index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.count.calc_reads_per_pos" title="Permalink to this definition"></a></dt>
<dd><p>For each position, find all reads matching a pattern.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.count.calc_rels_per_pos">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.count.</span></span><span class="sig-name descname"><span class="pre">calc_rels_per_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mutations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_reads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cover_per_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_indexes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.count.calc_rels_per_pos" title="Permalink to this definition"></a></dt>
<dd><p>For each relationship, the number of reads at each position.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.count.calc_rels_per_read">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.count.</span></span><span class="sig-name descname"><span class="pre">calc_rels_per_read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mutations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.indexes.base.Index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cover_per_read</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_indexes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.count.calc_rels_per_read" title="Permalink to this definition"></a></dt>
<dd><p>For each relationship, the number of positions in each read.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.count.count_end_coords">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.count.</span></span><span class="sig-name descname"><span class="pre">count_end_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.count.count_end_coords" title="Permalink to this definition"></a></dt>
<dd><p>Count each pair of 5’ and 3’ end coordinates.</p>
</dd></dl>

<span class="target" id="module-seismicrna.core.batch.ends"></span><dl class="py class">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.EndCoords">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.ends.</span></span><span class="sig-name descname"><span class="pre">EndCoords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.seq.html#seismicrna.core.seq.section.Section" title="seismicrna.core.seq.section.Section"><span class="pre">seismicrna.core.seq.section.Section</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sanitize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.ends.EndCoords" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Collection of 5’ and 3’ segment end coordinates.</p>
<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.EndCoords.contiguous">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">contiguous</span></span><a class="headerlink" href="#seismicrna.core.batch.ends.EndCoords.contiguous" title="Permalink to this definition"></a></dt>
<dd><p>Whether the segments of each read are contiguous.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.EndCoords.num_contiguous">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_contiguous</span></span><a class="headerlink" href="#seismicrna.core.batch.ends.EndCoords.num_contiguous" title="Permalink to this definition"></a></dt>
<dd><p>Number of contiguous reads.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.EndCoords.num_discontiguous">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_discontiguous</span></span><a class="headerlink" href="#seismicrna.core.batch.ends.EndCoords.num_discontiguous" title="Permalink to this definition"></a></dt>
<dd><p>Number of discontiguous reads.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.EndCoords.num_reads">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_reads</span></span><a class="headerlink" href="#seismicrna.core.batch.ends.EndCoords.num_reads" title="Permalink to this definition"></a></dt>
<dd><p>Number of reads.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.EndCoords.num_segments">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_segments</span></span><a class="headerlink" href="#seismicrna.core.batch.ends.EndCoords.num_segments" title="Permalink to this definition"></a></dt>
<dd><p>Number of segments in each read.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.EndCoords.pos_dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pos_dtype</span></span><a class="headerlink" href="#seismicrna.core.batch.ends.EndCoords.pos_dtype" title="Permalink to this definition"></a></dt>
<dd><p>Data type for positions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.EndCoords.read_end3s">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_end3s</span></span><a class="headerlink" href="#seismicrna.core.batch.ends.EndCoords.read_end3s" title="Permalink to this definition"></a></dt>
<dd><p>3’ end of each read.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.EndCoords.read_end5s">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_end5s</span></span><a class="headerlink" href="#seismicrna.core.batch.ends.EndCoords.read_end5s" title="Permalink to this definition"></a></dt>
<dd><p>5’ end of each read.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.EndCoords.seg_end3s">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seg_end3s</span></span><a class="headerlink" href="#seismicrna.core.batch.ends.EndCoords.seg_end3s" title="Permalink to this definition"></a></dt>
<dd><p>3’ end of each segment in each read.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.EndCoords.seg_end5s">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">seg_end5s</span></span><a class="headerlink" href="#seismicrna.core.batch.ends.EndCoords.seg_end5s" title="Permalink to this definition"></a></dt>
<dd><p>5’ end of each segment in each read.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.count_reads_segments">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.ends.</span></span><span class="sig-name descname"><span class="pre">count_reads_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_ends</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">what</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'seg_ends'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#seismicrna.core.batch.ends.count_reads_segments" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.find_contiguous_reads">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.ends.</span></span><span class="sig-name descname"><span class="pre">find_contiguous_reads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.ends.find_contiguous_reads" title="Permalink to this definition"></a></dt>
<dd><p>Whether the segments of each read are contiguous.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.find_read_end3s">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.ends.</span></span><span class="sig-name descname"><span class="pre">find_read_end3s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.ends.find_read_end3s" title="Permalink to this definition"></a></dt>
<dd><p>Find the 3’ end of each read.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.find_read_end5s">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.ends.</span></span><span class="sig-name descname"><span class="pre">find_read_end5s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.ends.find_read_end5s" title="Permalink to this definition"></a></dt>
<dd><p>Find the 5’ end of each read.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.mask_segment_ends">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.ends.</span></span><span class="sig-name descname"><span class="pre">mask_segment_ends</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.ends.mask_segment_ends" title="Permalink to this definition"></a></dt>
<dd><p>Mask segments with no coverage (5’ end &gt; 3’ end).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.match_reads_segments">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.ends.</span></span><span class="sig-name descname"><span class="pre">match_reads_segments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.ends.match_reads_segments" title="Permalink to this definition"></a></dt>
<dd><p>Number of segments for the given end coordinates.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.merge_read_ends">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.ends.</span></span><span class="sig-name descname"><span class="pre">merge_read_ends</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">read_end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.ends.merge_read_ends" title="Permalink to this definition"></a></dt>
<dd><p>Return the 5’ and 3’ ends as one 2D array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.merge_segment_ends">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.ends.</span></span><span class="sig-name descname"><span class="pre">merge_segment_ends</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.ends.merge_segment_ends" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.sanitize_segment_ends">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.ends.</span></span><span class="sig-name descname"><span class="pre">sanitize_segment_ends</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.ends.sanitize_segment_ends" title="Permalink to this definition"></a></dt>
<dd><p>Sanitize end coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seg_end5s</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – 5’ end coordinate of each segment in each read.</p></li>
<li><p><strong>seg_end3s</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – 3’ end coordinate of each segment in each read.</p></li>
<li><p><strong>min_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Minimum allowed value of a position.</p></li>
<li><p><strong>max_pos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Maximum allowed value of a position.</p></li>
<li><p><strong>check_values</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></code>) – Whether to check the bounds of the values, which is the most
expensive operation in this function. Can be set to False if the
only desired effect is to ensure the output is a positive, even
number of arrays in the proper data type.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sanitized end coordinates: encoded in the most efficient data
type, and if <cite>check_values</cite> is True then all between <cite>min_pos</cite>
and <cite>max_pos</cite> (inclusive).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple[np.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.ends.sort_segment_ends">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.ends.</span></span><span class="sig-name descname"><span class="pre">sort_segment_ends</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seg_end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seg_end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zero_indexed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.ends.sort_segment_ends" title="Permalink to this definition"></a></dt>
<dd><p>Sort the segment end coordinates and label the 3’ end of each
contiguous set of segments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seg_end5s</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – 5’ end of each segment in each read; may be masked.</p></li>
<li><p><strong>seg_end3s</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – 3’ end of each segment in each read; may be masked.</p></li>
<li><p><strong>zero_indexed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></code>) – In the return array, make the 5’ ends 0-indexed; if False, then
they will be 1-indexed (like the input).</p></li>
<li><p><strong>fill_mask</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></code>) – If <cite>seg_end5s</cite> or <cite>seg_end3s</cite> is a masked array, then return a
regular array with all masked coordinates set to 0 (or 1 for
5’ ends if <cite>one_indexed</cite> is True) rather than a masked array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Sorted 5’ and 3’ coordinates of the segments in each read</p></li>
<li><p>Labels of whether each coordinate is a 5’ end of a segment</p></li>
<li><p>Labels of whether each coordinate is a 3’ end of a contiguous
segment</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple[np.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray]</span></code></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-seismicrna.core.batch.index"></span><dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.index.count_base_types">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.index.</span></span><span class="sig-name descname"><span class="pre">count_base_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_pos_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.indexes.base.Index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.index.count_base_types" title="Permalink to this definition"></a></dt>
<dd><p>Return the number of each type of base in the index of positions
and bases.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.index.iter_base_types">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.index.</span></span><span class="sig-name descname"><span class="pre">iter_base_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_pos_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.indexes.base.Index</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.index.iter_base_types" title="Permalink to this definition"></a></dt>
<dd><p>For each type of base in the index of positions and bases, yield
the positions in the index with that type of base.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.index.iter_windows">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.index.</span></span><span class="sig-name descname"><span class="pre">iter_windows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_nums</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.index.iter_windows" title="Permalink to this definition"></a></dt>
<dd><p>Yield the positions in each window of size positions of the
section.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.index.list_batch_nums">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.index.</span></span><span class="sig-name descname"><span class="pre">list_batch_nums</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.index.list_batch_nums" title="Permalink to this definition"></a></dt>
<dd><p>List the batch numbers.</p>
</dd></dl>

<span class="target" id="module-seismicrna.core.batch.muts"></span><dl class="py class">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.MutsBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.muts.</span></span><span class="sig-name descname"><span class="pre">MutsBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.seq.html#seismicrna.core.seq.section.Section" title="seismicrna.core.seq.section.Section"><span class="pre">seismicrna.core.seq.section.Section</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sanitize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.muts.MutsBatch" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#seismicrna.core.batch.ends.EndCoords" title="seismicrna.core.batch.ends.EndCoords"><code class="xref py py-class docutils literal notranslate"><span class="pre">seismicrna.core.batch.ends.EndCoords</span></code></a>, <a class="reference internal" href="#seismicrna.core.batch.read.ReadBatch" title="seismicrna.core.batch.read.ReadBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">seismicrna.core.batch.read.ReadBatch</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>Batch of mutational data.</p>
<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.MutsBatch.muts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">muts</span></span><a class="headerlink" href="#seismicrna.core.batch.muts.MutsBatch.muts" title="Permalink to this definition"></a></dt>
<dd><p>Reads with each type of mutation at each position.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.MutsBatch.pos_nums">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pos_nums</span></span><a class="headerlink" href="#seismicrna.core.batch.muts.MutsBatch.pos_nums" title="Permalink to this definition"></a></dt>
<dd><p>Positions in use.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.MutsBatch.read_end_counts">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_end_counts</span></span><a class="headerlink" href="#seismicrna.core.batch.muts.MutsBatch.read_end_counts" title="Permalink to this definition"></a></dt>
<dd><p>Counts of read end coordinates.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.MutsBatch.read_weights">
<em class="property"><span class="pre">abstract</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_weights</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a></em><a class="headerlink" href="#seismicrna.core.batch.muts.MutsBatch.read_weights" title="Permalink to this definition"></a></dt>
<dd><p>Weights for each read when computing counts.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.PartialMutsBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.muts.</span></span><span class="sig-name descname"><span class="pre">PartialMutsBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.seq.html#seismicrna.core.seq.section.Section" title="seismicrna.core.seq.section.Section"><span class="pre">seismicrna.core.seq.section.Section</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sanitize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.muts.PartialMutsBatch" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#seismicrna.core.batch.muts.MutsBatch" title="seismicrna.core.batch.muts.MutsBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">seismicrna.core.batch.muts.MutsBatch</span></code></a>, <a class="reference internal" href="#seismicrna.core.batch.read.PartialReadBatch" title="seismicrna.core.batch.read.PartialReadBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">seismicrna.core.batch.read.PartialReadBatch</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.SectionMutsBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.muts.</span></span><span class="sig-name descname"><span class="pre">SectionMutsBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.seq.html#seismicrna.core.seq.section.Section" title="seismicrna.core.seq.section.Section"><span class="pre">seismicrna.core.seq.section.Section</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.muts.SectionMutsBatch" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#seismicrna.core.batch.muts.MutsBatch" title="seismicrna.core.batch.muts.MutsBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">seismicrna.core.batch.muts.MutsBatch</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>Batch of mutational data that knows its section.</p>
<dl class="py method">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.SectionMutsBatch.count_per_pos">
<span class="sig-name descname"><span class="pre">count_per_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.rel.html#seismicrna.core.rel.pattern.RelPattern" title="seismicrna.core.rel.pattern.RelPattern"><span class="pre">seismicrna.core.rel.pattern.RelPattern</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.muts.SectionMutsBatch.count_per_pos" title="Permalink to this definition"></a></dt>
<dd><p>Count the reads that fit a relationship pattern at each
position in a section.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.SectionMutsBatch.count_per_read">
<span class="sig-name descname"><span class="pre">count_per_read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.rel.html#seismicrna.core.rel.pattern.RelPattern" title="seismicrna.core.rel.pattern.RelPattern"><span class="pre">seismicrna.core.rel.pattern.RelPattern</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.muts.SectionMutsBatch.count_per_read" title="Permalink to this definition"></a></dt>
<dd><p>Count the positions in a section that fit a relationship
pattern in each read.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.SectionMutsBatch.cover_per_pos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cover_per_pos</span></span><a class="headerlink" href="#seismicrna.core.batch.muts.SectionMutsBatch.cover_per_pos" title="Permalink to this definition"></a></dt>
<dd><p>Number of reads covering each position.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.SectionMutsBatch.cover_per_read">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cover_per_read</span></span><a class="headerlink" href="#seismicrna.core.batch.muts.SectionMutsBatch.cover_per_read" title="Permalink to this definition"></a></dt>
<dd><p>Number of positions covered by each read.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.SectionMutsBatch.iter_reads">
<span class="sig-name descname"><span class="pre">iter_reads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.rel.html#seismicrna.core.rel.pattern.RelPattern" title="seismicrna.core.rel.pattern.RelPattern"><span class="pre">seismicrna.core.rel.pattern.RelPattern</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">only_read_ends</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">require_contiguous</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.muts.SectionMutsBatch.iter_reads" title="Permalink to this definition"></a></dt>
<dd><p>End coordinates and mutated positions in each read.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.SectionMutsBatch.iter_windows">
<span class="sig-name descname"><span class="pre">iter_windows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.muts.SectionMutsBatch.iter_windows" title="Permalink to this definition"></a></dt>
<dd><p>Yield the positions in each window of the section.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.SectionMutsBatch.pos_index">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pos_index</span></span><a class="headerlink" href="#seismicrna.core.batch.muts.SectionMutsBatch.pos_index" title="Permalink to this definition"></a></dt>
<dd><p>Index of unmasked positions and bases.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.SectionMutsBatch.reads_noclose_muts">
<span class="sig-name descname"><span class="pre">reads_noclose_muts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.rel.html#seismicrna.core.rel.pattern.RelPattern" title="seismicrna.core.rel.pattern.RelPattern"><span class="pre">seismicrna.core.rel.pattern.RelPattern</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_gap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.muts.SectionMutsBatch.reads_noclose_muts" title="Permalink to this definition"></a></dt>
<dd><p>List the reads with no two mutations too close.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.SectionMutsBatch.reads_per_pos">
<span class="sig-name descname"><span class="pre">reads_per_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.rel.html#seismicrna.core.rel.pattern.RelPattern" title="seismicrna.core.rel.pattern.RelPattern"><span class="pre">seismicrna.core.rel.pattern.RelPattern</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.muts.SectionMutsBatch.reads_per_pos" title="Permalink to this definition"></a></dt>
<dd><p>For each position, find all reads matching a relationship
pattern.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.SectionMutsBatch.rels_per_pos">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rels_per_pos</span></span><a class="headerlink" href="#seismicrna.core.batch.muts.SectionMutsBatch.rels_per_pos" title="Permalink to this definition"></a></dt>
<dd><p>For each relationship, the number of reads at each position
with that relationship.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.SectionMutsBatch.rels_per_read">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">rels_per_read</span></span><a class="headerlink" href="#seismicrna.core.batch.muts.SectionMutsBatch.rels_per_read" title="Permalink to this definition"></a></dt>
<dd><p>For each relationship, the number of positions in each read
with that relationship.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.batch.muts.sanitize_muts">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.muts.</span></span><span class="sig-name descname"><span class="pre">sanitize_muts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">muts</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">section</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="seismicrna.core.seq.html#seismicrna.core.seq.section.Section" title="seismicrna.core.seq.section.Section"><span class="pre">seismicrna.core.seq.section.Section</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.12)"><span class="pre">type</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">sanitize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.muts.sanitize_muts" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<span class="target" id="module-seismicrna.core.batch.read"></span><dl class="py class">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.AllReadBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.read.</span></span><span class="sig-name descname"><span class="pre">AllReadBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.read.AllReadBatch" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#seismicrna.core.batch.read.ReadBatch" title="seismicrna.core.batch.read.ReadBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">seismicrna.core.batch.read.ReadBatch</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.AllReadBatch.max_read">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_read</span></span><a class="headerlink" href="#seismicrna.core.batch.read.AllReadBatch.max_read" title="Permalink to this definition"></a></dt>
<dd><p>Maximum possible value for a read index.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.AllReadBatch.read_indexes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_indexes</span></span><a class="headerlink" href="#seismicrna.core.batch.read.AllReadBatch.read_indexes" title="Permalink to this definition"></a></dt>
<dd><p>Map each read number to its index in self.read_nums.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.AllReadBatch.read_nums">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_nums</span></span><a class="headerlink" href="#seismicrna.core.batch.read.AllReadBatch.read_nums" title="Permalink to this definition"></a></dt>
<dd><p>Read numbers.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.PartialReadBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.read.</span></span><span class="sig-name descname"><span class="pre">PartialReadBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.read.PartialReadBatch" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#seismicrna.core.batch.read.ReadBatch" title="seismicrna.core.batch.read.ReadBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">seismicrna.core.batch.read.ReadBatch</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.PartialReadBatch.max_read">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_read</span></span><a class="headerlink" href="#seismicrna.core.batch.read.PartialReadBatch.max_read" title="Permalink to this definition"></a></dt>
<dd><p>Maximum possible value for a read index.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.PartialReadBatch.read_indexes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_indexes</span></span><a class="headerlink" href="#seismicrna.core.batch.read.PartialReadBatch.read_indexes" title="Permalink to this definition"></a></dt>
<dd><p>Map each read number to its index in self.read_nums.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.ReadBatch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">seismicrna.core.batch.read.</span></span><span class="sig-name descname"><span class="pre">ReadBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.batch.read.ReadBatch" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>Batch of reads.</p>
<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.ReadBatch.batch_read_index">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_read_index</span></span><a class="headerlink" href="#seismicrna.core.batch.read.ReadBatch.batch_read_index" title="Permalink to this definition"></a></dt>
<dd><p>MultiIndex of the batch number and read numbers.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.ReadBatch.max_read">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_read</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></em><a class="headerlink" href="#seismicrna.core.batch.read.ReadBatch.max_read" title="Permalink to this definition"></a></dt>
<dd><p>Maximum possible value for a read index.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.ReadBatch.num_reads">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_reads</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span></em><a class="headerlink" href="#seismicrna.core.batch.read.ReadBatch.num_reads" title="Permalink to this definition"></a></dt>
<dd><p>Number of reads.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.ReadBatch.read_dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_dtype</span></span><a class="headerlink" href="#seismicrna.core.batch.read.ReadBatch.read_dtype" title="Permalink to this definition"></a></dt>
<dd><p>Data type for read numbers.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.ReadBatch.read_indexes">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_indexes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#seismicrna.core.batch.read.ReadBatch.read_indexes" title="Permalink to this definition"></a></dt>
<dd><p>Map each read number to its index in self.read_nums.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="seismicrna.core.batch.read.ReadBatch.read_nums">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_nums</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span></em><a class="headerlink" href="#seismicrna.core.batch.read.ReadBatch.read_nums" title="Permalink to this definition"></a></dt>
<dd><p>Read numbers.</p>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="seismicrna.core.arg.html" class="btn btn-neutral float-left" title="seismicrna.core.arg package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="seismicrna.core.batch.tests.html" class="btn btn-neutral float-right" title="seismicrna.core.batch.tests package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, the Rouskin Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>