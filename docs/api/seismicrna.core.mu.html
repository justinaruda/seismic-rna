<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>seismicrna.core.mu package &mdash; seismic-rna  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon-32x32.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="seismicrna.core.mu.tests package" href="seismicrna.core.mu.tests.html" />
    <link rel="prev" title="seismicrna.core.io.tests package" href="seismicrna.core.io.tests.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            seismic-rna
              <img src="../_static/logo-200.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whatdoes/index.html">What it Does</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="../steps/index.html">Step-By-Step</a></li>
<li class="toctree-l1"><a class="reference internal" href="../howto/index.html">How To</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Commands, Arguments, Options</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="seismicrna.html">seismicrna package</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="seismicrna.html#seismic-rna">SEISMIC-RNA</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="seismicrna.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="seismicrna.align.html">seismicrna.align package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.cleanfa.html">seismicrna.cleanfa package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.cluster.html">seismicrna.cluster package</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="seismicrna.core.html">seismicrna.core package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="seismicrna.core.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="seismicrna.core.html#module-seismicrna.core.data">Submodules</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.demult.html">seismicrna.demult package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.export.html">seismicrna.export package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.fold.html">seismicrna.fold package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.graph.html">seismicrna.graph package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.join.html">seismicrna.join package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.lists.html">seismicrna.lists package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.mask.html">seismicrna.mask package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.pool.html">seismicrna.pool package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.relate.html">seismicrna.relate package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.renumct.html">seismicrna.renumct package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.sim.html">seismicrna.sim package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.table.html">seismicrna.table package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.test.html">seismicrna.test package</a></li>
<li class="toctree-l3"><a class="reference internal" href="seismicrna.wf.html">seismicrna.wf package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="seismicrna.html#module-seismicrna.main">Submodules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../formats/index.html">File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data/index.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algos/index.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../issues.html">Bugs and Requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../writeme.html">How to Write this Manual</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">seismic-rna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="seismicrna.html">seismicrna package</a></li>
          <li class="breadcrumb-item"><a href="seismicrna.core.html">seismicrna.core package</a></li>
      <li class="breadcrumb-item active">seismicrna.core.mu package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/seismicrna.core.mu.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-seismicrna.core.mu">
<span id="seismicrna-core-mu-package"></span><h1>seismicrna.core.mu package<a class="headerlink" href="#module-seismicrna.core.mu" title="Permalink to this headline"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="seismicrna.core.mu.tests.html">seismicrna.core.mu.tests package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="seismicrna.core.mu.tests.html#module-seismicrna.core.mu.tests.compare_test">Submodules</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="module-seismicrna.core.mu.compare">
<span id="submodules"></span><h2>Submodules<a class="headerlink" href="#module-seismicrna.core.mu.compare" title="Permalink to this headline"></a></h2>
<p>Pairwise comparisons of mutation rates.</p>
<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.compare.calc_coeff_determ">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.compare.</span></span><span class="sig-name descname"><span class="pre">calc_coeff_determ</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mus2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.compare.calc_coeff_determ" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the coefficient of determination (a.k.a. R-squared)
between two groups of mutation rates, ignoring NaNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mus1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code>) – First group of mutation rates; can contain multiple sets as the
columns of a multidimensional array or DataFrame.</p></li>
<li><p><strong>mus2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code>) – Second group of mutation rates; can contain multiple sets as the
columns of a multidimensional array or DataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Coefficient of determination.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">|</span> <span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.compare.calc_nrmsd">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.compare.</span></span><span class="sig-name descname"><span class="pre">calc_nrmsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mus2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.compare.calc_nrmsd" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the normalized root-mean-square deviation (NRMSD) of
two groups of mutation rates, ignoring NaNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mus1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code>) – First group of mutation rates; can contain multiple sets as the
columns of a multidimensional array or DataFrame.</p></li>
<li><p><strong>mus2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code>) – Second group of mutation rates; can contain multiple sets as the
columns of a multidimensional array or DataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Normalized root-mean-square deviation (NRMSD)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.compare.calc_pearson">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.compare.</span></span><span class="sig-name descname"><span class="pre">calc_pearson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mus2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.compare.calc_pearson" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the Pearson correlation coefficient between two groups
of mutation rates, ignoring NaNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mus1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code>) – First group of mutation rates; can contain multiple sets as the
columns of a multidimensional array or DataFrame.</p></li>
<li><p><strong>mus2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code>) – Second group of mutation rates; can contain multiple sets as the
columns of a multidimensional array or DataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pearson correlation coefficient.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">|</span> <span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.compare.calc_rmsd">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.compare.</span></span><span class="sig-name descname"><span class="pre">calc_rmsd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mus2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.compare.calc_rmsd" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the root-mean-square deviation (RMSD) of two groups of
mutation rates, ignoring NaNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mus1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code>) – First group of mutation rates; can contain multiple sets as the
columns of a multidimensional array or DataFrame.</p></li>
<li><p><strong>mus2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code>) – Second group of mutation rates; can contain multiple sets as the
columns of a multidimensional array or DataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Root-mean-square deviation (RMSD)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.compare.calc_spearman">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.compare.</span></span><span class="sig-name descname"><span class="pre">calc_spearman</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mus2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.compare.calc_spearman" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the Spearman rank correlation coefficient between two
groups of mutation rates, ignoring NaNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mus1</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code>) – First group of mutation rates; can contain multiple sets as the
columns of a multidimensional array or DataFrame.</p></li>
<li><p><strong>mus2</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code>) – Second group of mutation rates; can contain multiple sets as the
columns of a multidimensional array or DataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Spearman rank correlation coefficient.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">|</span> <span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.compare.compare_windows">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.compare.</span></span><span class="sig-name descname"><span class="pre">compare_windows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.series.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mus2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.series.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.compare.compare_windows" title="Permalink to this definition"></a></dt>
<dd><p>Compare two Series via sliding windows.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.compare.get_comp_func">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.compare.</span></span><span class="sig-name descname"><span class="pre">get_comp_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></span><a class="headerlink" href="#seismicrna.core.mu.compare.get_comp_func" title="Permalink to this definition"></a></dt>
<dd><p>Get the function of a comparison method based on its key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Key with which to retrieve the comparison function.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Function to compare mutation rates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.compare.get_comp_name">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.compare.</span></span><span class="sig-name descname"><span class="pre">get_comp_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><span class="pre">str</span></a></span></span><a class="headerlink" href="#seismicrna.core.mu.compare.get_comp_name" title="Permalink to this definition"></a></dt>
<dd><p>Get the name of a comparison method based on its key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>) – Key with which to retrieve the comparison method name.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Name of the comparison method.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-seismicrna.core.mu.dim"></span><dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.dim.count_pos">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.dim.</span></span><span class="sig-name descname"><span class="pre">count_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.dim.count_pos" title="Permalink to this definition"></a></dt>
<dd><p>Count the positions in an array of mutation rates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Mutation rates. Multiple sets of mutation rates can be given as
columns of a multidimensional array or DataFrame.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of positions in the array of mutation rates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.dim.counts_pos">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.dim.</span></span><span class="sig-name descname"><span class="pre">counts_pos</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.dim.counts_pos" title="Permalink to this definition"></a></dt>
<dd><p>Count the positions in each array of mutation rates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Groups of mutation rates; each can contain multiple sets as the
columns of a multidimensional array or DataFrame.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of positions in each array of mutation rates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple[int</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.dim.counts_pos_consensus">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.dim.</span></span><span class="sig-name descname"><span class="pre">counts_pos_consensus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.dim.counts_pos_consensus" title="Permalink to this definition"></a></dt>
<dd><p>Find the number of positions in every array of mutation rates;
every array must have the same number of positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Groups of mutation rates; each can contain multiple sets as the
columns of a multidimensional array.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of positions in every array of mutation rates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-seismicrna.core.mu.frame"></span><dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.frame.auto_reframe">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.frame.</span></span><span class="sig-name descname"><span class="pre">auto_reframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.frame.auto_reframe" title="Permalink to this definition"></a></dt>
<dd><p>Decorate a function with one positional argument of data so that
it converts the input data to a NumPy array, runs, and then reframes
the return value using the original argument as the target.</p>
<p>Note that if &#64;auto_reframe and &#64;auto_remove_nan are used to decorate
the same function, then auto_reframe should be the inner decorator.
If auto_remove_nan is the inner decorator and removes any NaNs, then
auto_reframe will attempt to broadcast the NaN-less axis 0 over the
original (longer) axis 0. This operation would raise a ValueError
or, worse, if the NaN-less axis 0 happened to have length 1, would
still broadcast to the original axis, causing a silent bug.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.frame.reframe">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.frame.</span></span><span class="sig-name descname"><span class="pre">reframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.12)"><span class="pre">numbers.Number</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.12)"><span class="pre">Union</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><span class="pre">None</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.indexes.base.Index</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.frame.reframe" title="Permalink to this definition"></a></dt>
<dd><p>Place the values in an array object with the given axes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Number</span> <span class="pre">|</span> <span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Value(s) to place in a new array-like object.</p></li>
<li><p><strong>axes</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">None</span> <span class="pre">|</span> <span class="pre">tuple[int</span> <span class="pre">|</span> <span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Index</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">]</span> <span class="pre">=</span> <span class="pre">None</span></code>) – <p>Axes of the new array-like object, specified as follows:</p>
<ul>
<li><p>If None, then return just the values as a NumPy array.</p></li>
<li><p>If a tuple, then each element creates an axis as follows:</p>
<ul class="simple">
<li><p>If an integer, then force the corresponding axis to be of
that length.</p></li>
<li><p>If an array-like, then assign the axis a Pandas Index from
the values in the element.</p></li>
</ul>
<p>Then, the array and index types are determined as follows:</p>
<ul class="simple">
<li><p>If all elements are integers, then return a NumPy array in
which the values are broadcast to the shape given by axes.</p></li>
<li><p>If at least one element is array-like, then return a Pandas
object (a Series if axes has one item, a DataFrame if two).</p></li>
<li><p>If integers and array-like items are mixed, then replace
each integer with a Pandas RangeIndex.</p></li>
</ul>
</li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value(s) in their new array-like object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.frame.reframe_like">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.frame.</span></span><span class="sig-name descname"><span class="pre">reframe_like</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/numbers.html#numbers.Number" title="(in Python v3.12)"><span class="pre">numbers.Number</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.frame.reframe_like" title="Permalink to this definition"></a></dt>
<dd><p>Place the values in an array object with the same type and axes
as target.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Number</span> <span class="pre">|</span> <span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Value(s) to place in a new array-like object.</p></li>
<li><p><strong>target</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Array object whose type and axes are to be used for constructing
the returned array.</p></li>
<li><p><strong>drop</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></code>) – Reduce the dimensionality of the target by dropping this number
of axes, starting from axis 0 and continuing upwards.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value(s) in their new array-like object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-seismicrna.core.mu.nan"></span><p>Comparisons of arbitrary numbers of mutation rates.</p>
<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.nan.any_nan">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.nan.</span></span><span class="sig-name descname"><span class="pre">any_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.nan.any_nan" title="Permalink to this definition"></a></dt>
<dd><p>Boolean array of positions where any mutation rate is NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Mutation rates. Multiple sets of mutation rates can be given as
columns of a multidimensional array or DataFrame.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Boolean array of positions where any mutation rate is NaN.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.nan.auto_remove_nan">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.nan.</span></span><span class="sig-name descname"><span class="pre">auto_remove_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.nan.auto_remove_nan" title="Permalink to this definition"></a></dt>
<dd><p>Decorate a function with one positional argument of mutation
rates so that it automatically removes positions with NaNs from the
input argument (but, if while using the NaN-less input, the function
produces any new NaNs, then those NaNs will be returned).</p>
<p>Note that if &#64;auto_reframe and &#64;auto_remove_nan are used to decorate
the same function, then auto_reframe should be the inner decorator.
If auto_remove_nan is the inner decorator and removes any NaNs, then
auto_reframe will attempt to broadcast the NaN-less axis 0 over the
original (longer) axis 0. This operation would raise a ValueError
or, worse, if the NaN-less axis 0 happened to have length 1, would
still broadcast to the original axis, causing a silent bug.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.nan.auto_removes_nan">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.nan.</span></span><span class="sig-name descname"><span class="pre">auto_removes_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><span class="pre">Callable</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.nan.auto_removes_nan" title="Permalink to this definition"></a></dt>
<dd><p>Decorate a function with positional argument(s) of mutation
rates so that it automatically removes positions with NaNs from the
input argument (but, if while using the NaN-less input, the function
produces any new NaNs, then those NaNs will be returned).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.nan.no_nan">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.nan.</span></span><span class="sig-name descname"><span class="pre">no_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.nan.no_nan" title="Permalink to this definition"></a></dt>
<dd><p>Boolean array of positions where no mutation rate is NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Mutation rates. Multiple sets of mutation rates can be given as
columns of a multidimensional array or DataFrame.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Boolean array of positions where no mutation rate is NaN.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.nan.remove_nan">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.nan.</span></span><span class="sig-name descname"><span class="pre">remove_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.nan.remove_nan" title="Permalink to this definition"></a></dt>
<dd><p>Remove positions at which any mutation rate is NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Mutation rates. Multiple sets of mutation rates can be given as
columns of a multidimensional array or DataFrame.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mutation rates without NaN values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple[numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.nan.removes_nan">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.nan.</span></span><span class="sig-name descname"><span class="pre">removes_nan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.nan.removes_nan" title="Permalink to this definition"></a></dt>
<dd><p>Remove positions at which any mutation rate in any group is NaN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Groups of mutation rates; each can contain multiple sets as the
columns of a multidimensional array.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Mutation rates without NaN values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple[numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">]</span></code></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-seismicrna.core.mu.scale"></span><p>Scale mutation rates.</p>
<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.scale.calc_quantile">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.scale.</span></span><span class="sig-name descname"><span class="pre">calc_quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.scale.calc_quantile" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the mutation rate at a quantile, ignoring NaNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Mutation rates. Multiple sets of mutation rates can be given as
columns of a multidimensional array or DataFrame.</p></li>
<li><p><strong>quantile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Quantile to return from the mutation rates; must be in [0, 1].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of the quantile from the mutation rates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">|</span> <span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.scale.calc_ranks">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.scale.</span></span><span class="sig-name descname"><span class="pre">calc_ranks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.scale.calc_ranks" title="Permalink to this definition"></a></dt>
<dd><p>Rank the mutation rates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Mutation rates. Multiple sets of mutation rates can be given as
columns of a multidimensional array or DataFrame.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Ranks of the mutation rates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.scale.calc_rms">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.scale.</span></span><span class="sig-name descname"><span class="pre">calc_rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.scale.calc_rms" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the root-mean-square mutation rate, ignoring NaNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">pd.Series</span> <span class="pre">|</span> <span class="pre">pd.DataFrame</span></code>) – Mutation rates. Multiple sets of mutation rates can be given as
columns of a multidimensional array or DataFrame.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Root-mean-square mutation rate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">|</span> <span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.scale.normalize">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.scale.</span></span><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.scale.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Normalize the mutation rates to a quantile, so that the value of
the quantile is scaled to 1 and all other mutation rates are scaled
by the same factor. If quantile is 0, then do not normalize.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Mutation rates. Multiple sets of mutation rates can be given as
columns of a multidimensional array or DataFrame.</p></li>
<li><p><strong>quantile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Quantile for normalizing the mutation rates; must be in [0, 1].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Normalized mutation rates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.scale.standardize">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.scale.</span></span><span class="sig-name descname"><span class="pre">standardize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.scale.standardize" title="Permalink to this definition"></a></dt>
<dd><p>Standardize mutation rates so that the root-mean-square mutation
rate equals 1. Note that approximately half of the standardized
mutation rates will be greater than 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Mutation rates. Multiple sets of mutation rates can be given as
columns of a multidimensional array or DataFrame.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Standardized mutation rates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.scale.winsorize">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.scale.</span></span><span class="sig-name descname"><span class="pre">winsorize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mus</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.series.Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.scale.winsorize" title="Permalink to this definition"></a></dt>
<dd><p>Normalize and winsorize the mutation rates to a quantile so that
all mutation rates greater than or equal to the mutation rate at the
quantile are set to 1, and lesser mutation rates are normalized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mus</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code>) – Mutation rates. Multiple sets of mutation rates can be given as
columns of a multidimensional array or DataFrame.</p></li>
<li><p><strong>quantile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Quantile for normalizing the mutation rates; must be in [0, 1].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Normalized and winsorized mutation rates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span> <span class="pre">|</span> <span class="pre">pandas.Series</span> <span class="pre">|</span> <span class="pre">pandas.DataFrame</span></code></p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-seismicrna.core.mu.unbias"></span><p>Mutation Rate Core Module</p>
<hr class="docutils" />
<dl class="simple">
<dt>The functions in this module serve two main purposes:</dt><dd><ol class="arabic simple">
<li><p>Adjust mutation rates to correct for observer bias.</p></li>
<li><p>Normalize and winsorize mutation rates</p></li>
</ol>
</dd>
</dl>
<hr class="docutils" />
<p>Adjust mutation rates to correct for observer bias</p>
<p>Our lab has found that pairs of mutations in DMS-MaPseq data rarely have
fewer than three non-mutated bases separating them. We suspect that the
reverse transcriptase is prone to falling off or stalling at locations
in the RNA where DMS has methylated bases that are too close.</p>
<p>Regardless of the reason, mutations on nearby bases are not independent,
which violates a core assumption of the Bernoulli mixture model that we
use in the expectation-maximization clustering algorithm. Namely, that
mutations occur independently of each other, such that the likelihood of
observing a bit vector is the product of the mutation rate of each base
that is mutated and one minus the mutation rate (“non-mutation rate”) of
each base that is not mutated.</p>
<p>In order to use the Bernoulli mixture model for expectation-maximization
clustering, we modify it such that bases separated by zero, one, or two
other bases are no longer assumed to mutate independently. Specifically,
since pairs of close mutations are rare, we add the assumption that no
mutations separated by fewer than three non-mutated bases may occur, and
exclude the few bit vectors that have such close mutations.</p>
<p>When these bit vectors are assumed to exist in the original population
of RNA molecules but not appear in the observed data, the mutation rates
that are observed will differ from the real, underlying mutation rates,
which would include the unobserved bit vectors. The real mutation rates
must therefore be estimated from the observed mutation rates.</p>
<p>It is relatively easy to estimate the observed mutation rates given the
real mutation rates, but there is no closed-form solution that we know
of to estimate the real mutation rates from the observed mutation rates.
Thus, we use an iterative approach, based on Newton’s method for finding
the roots of functions. We initially guess the real mutation rates. Each
iteration, we estimate the mutation rates that would have been observed
given our current guess of the real mutation rates, and then subtract
the mutation rates that were actually observed. This difference would be
zero if we had accurately guessed the real mutation rates. Thus, we use
Newton’s method to solve for the real mutation rates that minimize this
difference. The details are described in the comments of this module and
in Tomezsko et al. (2020) (<a class="reference external" href="https://doi.org/10.1038/s41586-020-2253-5">https://doi.org/10.1038/s41586-020-2253-5</a>).</p>
<hr class="docutils" />
<p>Normalize and winsorize mutation rates</p>
<p>The mutation rates of an RNA may vary among different samples because of
variations in the chemical probing and mutational profiling procedure.
Thus, it is often helpful to compute “normalized” mutation rates that
can be compared directly across different samples and used to predict
secondary structures.</p>
<p>This module currently provides a simple method for normalizing mutation
rates. First, a specific quantile of the dataset is chosen, such as 0.95
(i.e. the 95th percentile). The mutation rate with this quantile is set
to 1.0, and all other mutation rates are scaled linearly.</p>
<p>If the chosen quantile is less than 1.0, then any mutation rates above
the quantile will be scaled to values greater than 1.0. Since these high
mutation rates may be exceptionally reactive bases, it is often helpful
to cap the normalized mutation rates to a maximum of 1.0. The winsorize
function in this module performs normalization and then sets any value
greater than 1.0 to 1.0.</p>
<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.unbias.calc_p_clust">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.unbias.</span></span><span class="sig-name descname"><span class="pre">calc_p_clust</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_clust_observed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_noclose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.unbias.calc_p_clust" title="Permalink to this definition"></a></dt>
<dd><p>Cluster proportion among all reads.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_clust_observed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Proportion of each cluster among reads with no two mutations too
close.
1D (clusters)</p></li>
<li><p><strong>p_noclose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Probability that a read from each cluster would have no two
mutations too close.
1D (clusters)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Proportion of each cluster among all reads.
1D (clusters)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.unbias.calc_p_clust_given_noclose">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.unbias.</span></span><span class="sig-name descname"><span class="pre">calc_p_clust_given_noclose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_clust</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_noclose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.unbias.calc_p_clust_given_noclose" title="Permalink to this definition"></a></dt>
<dd><p>Cluster proportions among reads with no two mutations too close.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_clust</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Proportion of each cluster among all reads.
1D (clusters)</p></li>
<li><p><strong>p_noclose</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Probability that a read from each cluster would have no two
mutations too close.
1D (clusters)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Proportion of each cluster among reads with no two mutations too
close.
1D (clusters)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.unbias.calc_p_ends_given_noclose">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.unbias.</span></span><span class="sig-name descname"><span class="pre">calc_p_ends_given_noclose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_ends</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_noclose_given_ends</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.unbias.calc_p_ends_given_noclose" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the proportion of reads with no two mutations too
close with each pair of 5’ and 3’ coordinates.</p>
<ul class="simple">
<li><p><cite>p_ends</cite> has 2 dimensions: (positions x clusters)</p></li>
<li><p>Every value in the upper triangle of <cite>p_ends</cite> is ≥ 0 and ≤ 1;
no values below the main diagonal are used.</p></li>
<li><p>The upper triangle of <cite>p_ends</cite> sums to 1.</p></li>
<li><p><cite>min_gap</cite> is a non-negative integer.</p></li>
<li><p><cite>p_mut_given_span</cite> has 2 dimensions:
(positions x clusters)</p></li>
<li><p>Every value in <cite>p_mut_given_span</cite> is ≥ 0 and ≤ 1.</p></li>
<li><p>There is at least 1 cluster.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_ends</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – 2D (positions x positions) array of the proportion of reads in
each cluster beginning at the row position and ending at the
column position.</p></li>
<li><p><strong>p_noclose_given_ends</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – 3D (positions x positions x clusters) array of the pobabilities
that a read with 5’ and 3’ coordinates corresponding to the row
and column would have no two mutations too close.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>3D (positions x positions x clusters) array of the proportion of
reads without mutations too close, beginning at the row position
and ending at the column position, in each cluster.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.unbias.calc_p_ends_observed">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.unbias.</span></span><span class="sig-name descname"><span class="pre">calc_p_ends_observed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">npos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.unbias.calc_p_ends_observed" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the proportion of each pair of 5’/3’ end coordinates
observed in <cite>end5s</cite> and <cite>end3s</cite>, optionally weighted by <cite>weights</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>npos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of positions.</p></li>
<li><p><strong>end5s</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – 5’ end coordinates of the reads: 1D array (reads)</p></li>
<li><p><strong>end3s</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – 3’ end coordinates of the reads: 1D array (reads)</p></li>
<li><p><strong>weights</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></code>) – Number of times each read occurs in each cluster:
2D array (reads x clusters)</p></li>
<li><p><strong>check_values</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></code>) – Check that <cite>end5s</cite>, <cite>end3s</cite>, and <cite>weights</cite> are all valid.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Fraction of reads with each 5’ (row) and 3’ (column) coordinate:
3D array (positions x positions x clusters)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.unbias.calc_p_noclose">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.unbias.</span></span><span class="sig-name descname"><span class="pre">calc_p_noclose</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_ends</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_noclose_given_ends</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.unbias.calc_p_noclose" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the proportion of each cluster considering only reads
with no two mutations too close.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.unbias.calc_p_noclose_given_ends">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.unbias.</span></span><span class="sig-name descname"><span class="pre">calc_p_noclose_given_ends</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_mut_given_span</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_gap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.unbias.calc_p_noclose_given_ends" title="Permalink to this definition"></a></dt>
<dd><p>Given underlying mutation rates (<cite>p_mut_given_span</cite>), calculate
the probability that a read starting at position (a) and ending at
position (b) would have no two mutations too close (i.e. separated
by fewer than <cite>min_gap</cite> non-mutated positions), for each combination
of (a) and (b) such that 1 ≤ a ≤ b ≤ L (in biological coordinates)
or 0 ≤ a ≤ b &lt; L (in Python coordinates).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_mut_given_span</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code>) – A 2D (positions x clusters) array of the underlying mutation
rates, i.e. the probability that a read has a mutation at
position (j) given that it contains position (j).</p></li>
<li><p><strong>min_gap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Minimum number of non-mutated bases between two mutations;
must be ≥ 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>3D (positions x positions x clusters) array of the probability
that a random read starting at position (a) (row) and ending at
position (b) (column) would have no two mutations too close.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.unbias.calc_params">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.unbias.</span></span><span class="sig-name descname"><span class="pre">calc_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_mut_given_span_observed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_ends_observed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_clust_observed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_gap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_p_mut_given_span</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_p_ends</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_p_clust</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.12)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prenormalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.unbias.calc_params" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the three sets of parameters based on observed data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_mut_given_span_observed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Observed probability that each position is mutated given that no
two mutations are too close:
2D array (positions x clusters)</p></li>
<li><p><strong>p_ends_observed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Observed proportion of reads aligned with each pair of 5’ and 3’
end coordinates given that no two mutations are too close:
3D array (positions x positions x clusters)</p></li>
<li><p><strong>p_clust_observed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Observed proportion of reads in each cluster given that no two
mutations are too close:
1D array (clusters)</p></li>
<li><p><strong>min_gap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Minimum number of non-mutated bases between two mutations. Must
be a non-negative integer.</p></li>
<li><p><strong>guess_p_mut_given_span</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></code>) – Initial guess for the probability that each position is mutated.
If given, must be a 2D array (positions x clusters); defaults to
<cite>p_mut_given_span_observed</cite>.</p></li>
<li><p><strong>guess_p_ends</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></code>) – Initial guess for the proportion of total reads aligned to each
pair of 5’ and 3’ end coordinates. If given, must be a 2D array
(positions x positions); defaults to <cite>p_ends_observed</cite>.</p></li>
<li><p><strong>guess_p_clust</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></code>) – Initial guess for the proportion of total reads in each cluster.
If given, must be a 1D array (clusters); defaults to
<cite>p_clust_observed</cite>.</p></li>
<li><p><strong>prenormalize</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></code>) – Fill missing values in <cite>guess_p_mut_given_span</cite>, <cite>guess_p_ends</cite>,
and <cite>guess_p_clust</cite>, and clip every value to be ≥ 0 and ≤ 1.
Ensure the proportions in <cite>guess_p_clust</cite> and the upper triangle
of <cite>guess_p_ends</cite> sum to 1.</p></li>
<li><p><strong>max_iter</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">int</span> <span class="pre">=</span> <span class="pre">128</span></code>) – Maximum number of iterations in which to refine the parameters.</p></li>
<li><p><strong>convergence_thresh</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.e-4</span></code>) – Convergence threshold based on the root-mean-square difference
in mutation rates between consecutive iterations.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments for <cite>_calc_p_mut_given_span</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.unbias.calc_params_observed">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.unbias.</span></span><span class="sig-name descname"><span class="pre">calc_params_observed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_pos_total</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">unmasked_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">muts_per_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end5s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end3s</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">counts_per_uniq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">membership</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.unbias.calc_params_observed" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the observed estimates of the parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_pos_total</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Total number of positions in the section.</p></li>
<li><p><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – Order of clustering.</p></li>
<li><p><strong>unmasked_pos</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable[int]</span></code>) – Unmasked positions; must be zero-indexed with respect to the
5’ end of the section.</p></li>
<li><p><strong>muts_per_pos</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Iterable[np.ndarray]</span></code>) – For each unmasked position, numbers of all reads with a mutation
at that position.</p></li>
<li><p><strong>end5s</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Coordinates of the 5’ ends of all reads; must be 0-indexed with
respect to the 5’ end of the section.</p></li>
<li><p><strong>end3s</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Coordinates of the 3’ ends of all reads; must be 0-indexed with
respect to the 5’ end of the section.</p></li>
<li><p><strong>counts_per_uniq</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Number of times each unique read occurs.</p></li>
<li><p><strong>membership</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Cluster memberships of each read: 2D array (reads x clusters)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple[np.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.unbias.calc_rectangluar_sum">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.unbias.</span></span><span class="sig-name descname"><span class="pre">calc_rectangluar_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.unbias.calc_rectangluar_sum" title="Permalink to this definition"></a></dt>
<dd><p>For each element of the main diagonal, calculate the sum over
the rectangular array from that element to the upper right corner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>array</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Array of at least two dimensions for which to calculate the sum
of each rectangular array from each element on the main diagonal
to the upper right corner. The first two dimensions must have
equal lengths.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array with all but the first dimension of <cite>array</cite> indicating the
sum of the array from each element on the main diagonal to the
upper right corner of <cite>array</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="seismicrna.core.mu.unbias.triu_log">
<span class="sig-prename descclassname"><span class="pre">seismicrna.core.mu.unbias.</span></span><span class="sig-name descname"><span class="pre">triu_log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#seismicrna.core.mu.unbias.triu_log" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the logarithm of the upper triangle(s) of array <cite>a</cite>.
In the result, elements below the main diagonal are undefined.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code>) – Array (≥ 2 dimensions) of whose upper triangle to compute the
logarithm; the first 2 dimensions must have equal lengths.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Logarithm of the upper triangle(s) of <cite>a</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">np.ndarray</span></code></p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="seismicrna.core.io.tests.html" class="btn btn-neutral float-left" title="seismicrna.core.io.tests package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="seismicrna.core.mu.tests.html" class="btn btn-neutral float-right" title="seismicrna.core.mu.tests package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, the Rouskin Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>