<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Relate each read to every reference position &mdash; seismic-rna  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon-32x32.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            seismic-rna
              <img src="../../_static/logo-200.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Manuals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/seismicrna.html">seismicrna package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../formats/index.html">File Formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data/index.html">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../algos/index.html">Algorithms</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">seismic-rna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Relate each read to every reference position</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/manuals/steps/relate.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="relate-each-read-to-every-reference-position">
<h1>Relate each read to every reference position<a class="headerlink" href="#relate-each-read-to-every-reference-position" title="Permalink to this headline"></a></h1>
<section id="input-files-for-relate">
<h2>Input files for relate<a class="headerlink" href="#input-files-for-relate" title="Permalink to this headline"></a></h2>
<p>Relate requires exactly one FASTA file containing one or more reference
sequences and any number of alignment map files in BAM format.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The references in the FASTA file must match those to which the reads
were aligned to produce the BAM file(s); the names and the sequences
must be identical. If the names differ, then the BAM files using the
old names will be ignored; while if the sequences differ, then reads
can yield erroneous relation vectors or fail outright.</p>
</div>
<section id="one-bam-file">
<h3>One BAM file<a class="headerlink" href="#one-bam-file" title="Permalink to this headline"></a></h3>
<p>A single BAM file (<code class="docutils literal notranslate"><span class="pre">sample_1/align/ref_1.bam</span></code>) can be run as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seismic</span> <span class="n">relate</span> <span class="n">refs</span><span class="o">.</span><span class="n">fa</span> <span class="n">sample_1</span><span class="o">/</span><span class="n">align</span><span class="o">/</span><span class="n">ref_1</span><span class="o">.</span><span class="n">bam</span>
</pre></div>
</div>
</section>
<section id="multiple-bam-files">
<h3>Multiple BAM files<a class="headerlink" href="#multiple-bam-files" title="Permalink to this headline"></a></h3>
<p>Multiple BAM files can be run in parallel by giving multiple paths:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seismic</span> <span class="n">relate</span> <span class="n">refs</span><span class="o">.</span><span class="n">fa</span> <span class="n">sample_1</span><span class="o">/</span><span class="n">align</span><span class="o">/</span><span class="n">ref_1</span><span class="o">.</span><span class="n">bam</span>
</pre></div>
</div>
<p>and/or by using <a href="#id1"><span class="problematic" id="id2">`glob patterns`_</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seismic</span> <span class="n">relate</span> <span class="n">refs</span><span class="o">.</span><span class="n">fa</span> <span class="n">sample_</span><span class="o">*/</span><span class="n">align</span><span class="o">/</span><span class="n">ref_1</span><span class="o">.</span><span class="n">bam</span> <span class="n">sample_</span><span class="o">*/</span><span class="n">align</span><span class="o">/</span><span class="n">ref_2</span><span class="o">.</span><span class="n">bam</span>
</pre></div>
</div>
</section>
<section id="bam-file-content-conventions">
<h3>BAM file content conventions<a class="headerlink" href="#bam-file-content-conventions" title="Permalink to this headline"></a></h3>
<p>Generally, a BAM file can contain reads that have aligned to any number
of reference, as well as unaligned reads. However, SEISMIC-RNA requires
that each BAM file contain reads aligned to exactly one reference. This
restriction enables the relate step to process BAM files in parallel,
which increases the speed. If the BAM files were created using <code class="docutils literal notranslate"><span class="pre">seismic</span>
<span class="pre">align</span></code>, then they will already follow this convention.</p>
</section>
<section id="bam-file-path-conventions">
<h3>BAM file path conventions<a class="headerlink" href="#bam-file-path-conventions" title="Permalink to this headline"></a></h3>
<p>The name of the BAM file (minus the extension <code class="docutils literal notranslate"><span class="pre">.bam</span></code>) must be the name
of the reference to which it was aligned. It must be inside a directory
named <code class="docutils literal notranslate"><span class="pre">align</span></code>, which must be inside a directory named after the sample
from which the reads came. If the BAM files were created using <code class="docutils literal notranslate"><span class="pre">seismic</span>
<span class="pre">align</span></code>, then they will already follow this convention.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, the Rouskin Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>